package sbs.src.service;



import java.security.PrivateKey;
import java.security.PublicKey;

public class GeneratePublicEncrypted {

	public static String encryptedData(String otp ,String username ,  String keypub)
	{   
		
		String string = otp+username;
		
		Pki.generateKeys();
		
		PrivateKey randompriv = Pki.priv1;
		byte[] randombyte = Pki.priToBytes(randompriv);
        String randomString =		Pki.bytesToHex(randombyte);
        
        System.out.println(randomString);
		
		
		
		
		
	String	key = "30820276020100300D06092A864886F70D0101010500048202603082025C02010002818100895B1BFDEFBA81998F0BDF0DF869F1431B92EEB741BEC327BF37728BC42CBC8AD1A9AEBDDB282285918076C671C320F1E1AB1C2DE7992B97FFC3C7515446B05A282DA2C89A3327FABC1F5CA976BF9F293FADE3B96BC9195E31ADFC49088F9899839FD240D0139CDCFDE64B8EBA24944B151374B08D2A52B4ECA1D1F873F6745B02030100010281804D0CC1C009E94A67F479494F91E904008C083946AD67B01BACC512C95A6B69FC492E712A6934B360CFC50B5BB8572834E74D500A641F64F7E7EE4FF1CC5FB6EE99B3369F40FEBE4643FE5E852D6D697CB97AE9BC02913A6C5A5F3AECCB15F49C81BD61D739A24B6FA951358F6D71FD2B206860F25A61E82AC5680C9D79A02109024100BE032303DD34E78D97927714501866F74B438597FC9C40016BAC39F093ACCE5BA4B03EBD48C05D2948754B488C619D8229FAAD83159DB9B2D6FD4663A9D64915024100B90E9BA21E47D38D353B05E913635364C9E7DCE19569055C60C2991293DABC3DE570C7C552D9F6F4516B13727E9CB587633893F6777FA7D7BA787913527243AF02407A87DF4EA0997B30ADABBFAA93B408C23400C8E7A7F8C2B5A7CF9A556F85A2552AB094E4CF436D502FEFA3AA970C63DC0A6222FE43344109F8E5BF3C89CB2BB902404463DDA8804053327065ABBD8368C5BD0DD11E944FBF4C37E39A872F926CD7FC97FAA2198E90F6EF3BD7B28C31B6806FD47F684F41C26FA90E44CF9A10722209024100B0F1279C83767CC9ED3B9925F4A54D0AAF6AAC0B8E8B6208E5AAB963BFCC5465F4C7A8D75B320660236DC77DBCCA8795EAAEBA86255412B98E7DD464A3EE4061";

	  	keypub ="30819F300D06092A864886F70D010101050003818D0030818902818100895B1BFDEFBA81998F0BDF0DF869F1431B92EEB741BEC327BF37728BC42CBC8AD1A9AEBDDB282285918076C671C320F1E1AB1C2DE7992B97FFC3C7515446B05A282DA2C89A3327FABC1F5CA976BF9F293FADE3B96BC9195E31ADFC49088F9899839FD240D0139CDCFDE64B8EBA24944B151374B08D2A52B4ECA1D1F873F6745B0203010001";
         
	   byte [] publicbyte = Pki.hexToBytes(keypub);
	  PublicKey  encrpublic = Pki.bytesToPub(publicbyte);
	  byte [] outputusingpub = Pki.pubEncrypt(string.getBytes(),encrpublic);
	   String finalencrpt = Pki.bytesToHex(outputusingpub);
	   
	   
	   byte [] privatebyte = Pki.hexToBytes(key);
	      byte[] output = Pki.priDecrypt(Pki.hexToBytes(finalencrpt), Pki.bytesToPri(Pki.hexToBytes(key)));
	     System.out.println("in generator pki "+ new String(output)); 
	      
	 /* byte[] output = Pki.pubDecrypt(string, encrpublic);
	   
	   byte [] privatebyte = Pki.hexToBytes(key);
	    
		byte [] plainBytes = string.getBytes();
	    byte [] encrprivate = Pki.priEncrypt(plainBytes, Pki.bytesToPri(privatebyte));
		
        byte [] pubbyte = Pki.hexToBytes(keypub);
	   
	    byte[] output = Pki.pubDecrypt(encrprivate, Pki.bytesToPub(pubbyte));
	  
	    System.out.println("in generator pki "+ new String(output));*/
	   
	   return finalencrpt;
	}
}
